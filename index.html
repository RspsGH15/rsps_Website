<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Rising Stars Public School | Welcome</title>
  <meta name="description" content="Official website of Rising Stars Public School. Simple, mobile-friendly site with About, Admissions, Gallery, Enquiry, and Contact." />
  <style>
    :root {
      --brand: #0b6ef3;
      --brand-dark: #094fb1;
      --ink: #1f2937;
      --muted: #6b7280;
      --bg: #f8fafc;
      --card: #ffffff;
      --accent: #10b981;
    }
    * { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji"; color: var(--ink); background: var(--bg); }
    a { color: var(--brand); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .container { max-width: 1100px; margin: 0 auto; padding: 0 16px; }

    /* Header */
    header { position: sticky; top: 0; z-index: 40; background: rgba(255,255,255,0.95); backdrop-filter: blur(6px); border-bottom: 1px solid #e5e7eb; }
    .nav { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; }
    .brand { display: flex; align-items: center; gap: 10px; font-weight: 700; font-size: 18px; }
    .brand img.logo { height: 36px; width: auto; border-radius: 6px; }
    .menu { display: flex; gap: 14px; align-items: center; }
    .menu a { padding: 8px 10px; border-radius: 8px; font-weight: 600; color: var(--ink); }
    .menu a:hover { background: #eef2ff; text-decoration: none; }
    .btn { display: inline-block; padding: 10px 14px; border-radius: 10px; font-weight: 700; color: #fff; background: var(--brand); }
    .btn:hover { background: var(--brand-dark); }
    .btn-outline { color: var(--brand); background: #fff; border: 1px solid var(--brand); }
    .btn-outline:hover { background: #eef2ff; }

    /* Mobile menu */
    .hamburger { display: none; background: transparent; border: 0; font-size: 22px; padding: 6px 8px; }
    #mobileMenu { display: none; border-top: 1px solid #e5e7eb; }
    #mobileMenu a { display: block; padding: 12px 8px; }

    @media (max-width: 860px) {
      .menu { display: none; }
      .hamburger { display: block; }
      #mobileMenu.open { display: block; }
    }

    /* Hero */
    .hero { background: linear-gradient(180deg, #e0f2fe 0%, #f8fafc 100%); padding: 36px 0 26px; border-bottom: 1px solid #e5e7eb; }
    .hero h1 { font-size: clamp(24px, 4vw, 38px); margin: 0 0 8px; }
    .hero p { color: var(--muted); margin: 0 0 18px; font-size: 16px; }
    .hero-cta { display: flex; flex-wrap: wrap; gap: 10px; }

    /* Quick links */
    .grid { display: grid; gap: 14px; grid-template-columns: repeat(3, 1fr); }
    @media (max-width: 860px) { .grid { grid-template-columns: 1fr; } }
    .card { background: var(--card); border: 1px solid #e5e7eb; border-radius: 14px; padding: 16px; box-shadow: 0 1px 2px rgba(0,0,0,0.04); }
    .card h3 { margin: 0 0 6px; font-size: 18px; }
    .card p { margin: 0 0 10px; color: var(--muted); }

    /* Sections */
    section { padding: 28px 0; }
    .section-title { font-size: 22px; margin: 0 0 12px; }

    /* Gallery */
    .gallery { display: grid; gap: 10px; grid-template-columns: repeat(4, 1fr); }
    @media (max-width: 860px) { .gallery { grid-template-columns: repeat(2, 1fr); } }
    .gallery img { width: 100%; height: 140px; object-fit: cover; border-radius: 12px; border: 1px solid #e5e7eb; }

    /* Enquiry */
    form.enquiry { display: grid; gap: 10px; grid-template-columns: 1fr 1fr; background: #ffffff; border: 1px solid #e5e7eb; border-radius: 14px; padding: 16px; }
    form.enquiry label { font-weight: 600; font-size: 14px; }
    form.enquiry input, form.enquiry select, form.enquiry textarea { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #d1d5db; font-size: 14px; }
    form.enquiry textarea { min-height: 90px; grid-column: 1 / -1; }
    form.enquiry .actions { grid-column: 1 / -1; display: flex; gap: 10px; flex-wrap: wrap; }

    /* Contact */
    .contact { display: grid; gap: 16px; grid-template-columns: 1.2fr 1fr; }
    @media (max-width: 860px) { .contact { grid-template-columns: 1fr; } }
    .info { background: var(--card); border: 1px solid #e5e7eb; border-radius: 14px; padding: 16px; }

    /* Footer */
    footer { margin-top: 24px; padding: 20px 0; background: #0f172a; color: #e2e8f0; }
    footer a { color: #bfdbfe; }
    .foot { display: grid; gap: 16px; grid-template-columns: 1fr 1fr 1fr; }
    @media (max-width: 860px) { .foot { grid-template-columns: 1fr; } }
    .small { color: #94a3b8; font-size: 13px; }
  </style>
</head>
<body>
<script>
  // If a password recovery link lands on index.html with a hash, forward it to reset.html
  if (location.hash && location.hash.includes('type=recovery')) {
    location.replace('reset.html' + location.hash);
  }
</script>

  <!-- Header -->
  <header>
    <div class="container nav">
      <div class="brand">
        <img class="logo" src="Rising Stars logo RSPS png.png" alt="Rising Stars Public School Logo">
        <div>Rising Stars Public School</div>
      </div>
      <nav class="menu" aria-label="Primary">
        <a href="#home">Home</a>
        <a href="#about">About Us</a>
        <a href="#admissions">Admissions</a>
        <a href="#gallery">Image Gallery</a>
        <a href="#enquiry">Enquiry</a>
        <a href="#contact">Contact Us</a>
        <a class="btn" href="#login">Login</a>
      </nav>
      <button class="hamburger" aria-label="Open menu" onclick="toggleMenu()">☰</button>
    </div>
    <div id="mobileMenu" class="container" aria-label="Mobile">
      <a href="#home" onclick="toggleMenu()">Home</a>
      <a href="#about" onclick="toggleMenu()">About Us</a>
      <a href="#admissions" onclick="toggleMenu()">Admissions</a>
      <a href="#gallery" onclick="toggleMenu()">Image Gallery</a>
      <a href="#enquiry" onclick="toggleMenu()">Enquiry</a>
      <a href="#contact" onclick="toggleMenu()">Contact Us</a>
      <a class="btn" href="#login" onclick="toggleMenu()">Login</a>
    </div>
  </header>

  <!-- Hero -->
  <main id="home" class="hero">
    <div class="container">
      <h1>Welcome to Rising Stars Public School</h1>
      <p>We believe in <strong>Parampara : Prodyogiki : Prakastha</strong> – meaning “Tradition, Technology, Excellence.” Our vision is to blend strong values and cultural heritage with modern education and smart use of technology, guiding every child towards excellence. <strong>सरल भाषा – आसान जानकारी.</strong></p>
      <div class="hero-cta">
        <a class="btn" href="#admissions">Apply for Admission</a>
        <a class="btn btn-outline" href="#enquiry">Ask a Question</a>
        <a class="btn btn-outline" href="tel:+919999999999" title="Phone number will be updated">Call Us</a>
      </div>
    </div>
  </main>

  <!-- Quick Links -->
  <section>
    <div class="container grid">
      <div class="card">
        <h3>About Us</h3>
        <p>Know our school, vision, and team.</p>
        <a class="btn btn-outline" href="#about">Read more</a>
      </div>
      <div class="card">
        <h3>Admissions</h3>
        <p>Process, documents, and fee structure.</p>
        <a class="btn btn-outline" href="#admissions">View details</a>
      </div>
      <div class="card">
        <h3>Image Gallery</h3>
        <p>Photos of school life and events.</p>
        <a class="btn btn-outline" href="#gallery">See photos</a>
      </div>
    </div>
  </section>

  <!-- About -->
  <section id="about">
    <div class="container">
      <h2 class="section-title">About Us</h2>
      <div class="card">
        <p>
          Rising Stars Public School is an elementary school serving the children of <strong>Village Shyampur, P.O. Gorkhuwala, Tehsil Paonta Sahib, District Sirmour, Himachal Pradesh – 173025</strong>.
          We focus on simple, clear teaching, strong values, and a safe environment.
        </p>
        <p>Our guiding principle <strong>Parampara : Prodyogiki : Prakastha</strong> means:</p>
        <ul>
          <li><strong>Parampara</strong> – respecting and following the good traditions of learning and discipline.</li>
          <li><strong>Prodyogiki</strong> – using modern tools and technology to enhance education.</li>
          <li><strong>Prakastha</strong> – aiming for the highest level of achievement and excellence.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Admissions -->
  <section id="admissions">
    <div class="container">
      <h2 class="section-title">Admissions</h2>
      <div class="card">
        <p>
          Admissions are open. Visit the school office with basic documents (Aadhaar, birth certificate, transfer certificate if any, and recent photographs) or send an enquiry below.
        </p>
        <p><strong>Fee Structure:</strong> Please contact the office for the latest fee details. We will update this page soon.</p>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:8px;">
          <a class="btn" href="#enquiry">Submit Enquiry</a>
          <a class="btn btn-outline" href="mailto:rspsshyampur@gmail.com">Email Admissions</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Gallery -->
  <section id="gallery">
    <div class="container">
      <h2 class="section-title">Image Gallery</h2>
      <div class="gallery" aria-label="School photos">
        <img src="https://picsum.photos/seed/school1/600/400" alt="School event photo 1" />
        <img src="https://picsum.photos/seed/school2/600/400" alt="School event photo 2" />
        <img src="https://picsum.photos/seed/school3/600/400" alt="School event photo 3" />
        <img src="https://picsum.photos/seed/school4/600/400" alt="School event photo 4" />
        <img src="https://picsum.photos/seed/school5/600/400" alt="School event photo 5" />
        <img src="https://picsum.photos/seed/school6/600/400" alt="School event photo 6" />
        <img src="https://picsum.photos/seed/school7/600/400" alt="School event photo 7" />
        <img src="https://picsum.photos/seed/school8/600/400" alt="School event photo 8" />
      </div>
    </div>
  </section>

  <!-- Enquiry -->
  <section id="enquiry">
    <div class="container">
      <h2 class="section-title">Enquiry (पूछताछ)</h2>
      <p class="small" style="margin-bottom:10px;">Fill the form below. You can also WhatsApp us—click the green button.</p>
      <form class="enquiry" onsubmit="return enquirySubmit(event)">
        <div>
          <label for="name">Parent Name</label>
          <input id="name" name="name" placeholder="Your full name" required />
        </div>
        <div>
          <label for="phone">Phone Number</label>
          <input id="phone" name="phone" placeholder="10-digit mobile" pattern="[0-9]{10}" required />
        </div>
        <div>
          <label for="student">Student Name</label>
          <input id="student" name="student" placeholder="Child's name" />
        </div>
        <div>
          <label for="class">Class Interested</label>
          <select id="class" name="class">
            <option value="Nursery">Nursery</option>
            <option value="LKG">LKG</option>
            <option value="UKG">UKG</option>
            <option value="1">Class 1</option>
            <option value="2">Class 2</option>
            <option value="3">Class 3</option>
            <option value="4">Class 4</option>
            <option value="5">Class 5</option>
            <option value="6">Class 6</option>
            <option value="7">Class 7</option>
            <option value="8">Class 8</option>
          </select>
        </div>
        <textarea id="message" name="message" placeholder="Your question (e.g., fees, transport, timing)"></textarea>
        <div class="actions">
          <button class="btn" type="submit">Send Enquiry</button>
          <a id="waLink" class="btn" style="background: var(--accent);" href="#" target="_blank" rel="noopener">WhatsApp Us</a>
          <a class="btn btn-outline" href="mailto:rspsshyampur@gmail.com?subject=Admission%20Enquiry">Email Us</a>
        </div>
        <p class="small">Note: We will call you back within 1 working day.</p>
      </form>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact">
    <div class="container contact">
      <div class="info">
        <h2 class="section-title">Contact Us</h2>
        <p><strong>Address:</strong><br/>Rising Stars Public School,<br/>Village Shyampur, P.O. Gorkhuwala,<br/>Tehsil Paonta Sahib, District Sirmour,<br/>Himachal Pradesh – 173025</p>
        <p><strong>Email:</strong> <a href="mailto:rspsshyampur@gmail.com">rspsshyampur@gmail.com</a></p>
        <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:8px;">
          <a class="btn" href="tel:+919999999999" title="Phone number will be updated">Call Now</a>
          <a class="btn btn-outline" href="#map">Open Map</a>
        </div>
      </div>
      <div class="card" id="map" aria-label="Map placeholder">
        <p style="margin-top:0;">Map will appear here. We will embed Google Map once your location link is ready.</p>
        <img src="https://maps.googleapis.com/maps/api/staticmap?center=Paonta%20Sahib,HP&zoom=12&size=600x300&markers=color:blue|Paonta%20Sahib" alt="Map placeholder" style="width:100%; height:auto; border-radius:12px; border:1px solid #e5e7eb;"/>
      </div>
    </div>
  </section>

  <!-- Login Placeholder -->
<!-- Login -->
<section id="login">
  <div class="container">
    <h2 class="section-title">User Login</h2>
    <p class="small" style="margin-bottom:8px;">Choose your role to log in. (Demo uses email+password for all roles.)</p>

    <div class="tabs" role="tablist" aria-label="Login roles" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px;">
      <button class="tab active" role="tab" aria-selected="true" aria-controls="studentTab" id="studentTabBtn" onclick="showTab('student')" style="padding:8px 12px;border:1px solid #c7d2fe;background:#eef2ff;border-radius:10px;cursor:pointer;font-weight:700;">Parent</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="teacherTab" id="teacherTabBtn" onclick="showTab('teacher')" style="padding:8px 12px;border:1px solid #c7d2fe;background:#eef2ff;border-radius:10px;cursor:pointer;font-weight:700;">Teacher</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="accountsTab" id="accountsTabBtn" onclick="showTab('accounts')" style="padding:8px 12px;border:1px solid #c7d2fe;background:#eef2ff;border-radius:10px;cursor:pointer;font-weight:700;">Accounts</button>
      <button class="tab" role="tab" aria-selected="false" aria-controls="adminTab" id="adminTabBtn" onclick="showTab('admin')" style="padding:8px 12px;border:1px solid #c7d2fe;background:#eef2ff;border-radius:10px;cursor:pointer;font-weight:700;">Admin</button>
    </div>

    <div class="login-grid" style="display:grid;gap:16px;grid-template-columns:1fr;">
      <!-- Parent (temporarily under "Student" tab id for existing JS) -->
      <div id="studentTab" role="tabpanel" aria-labelledby="studentTabBtn">
        <div class="card">
          <h3>Parent Login</h3>
          <form class="login" onsubmit="return false" style="display:grid;gap:10px;">
            <label for="studentPhone">Parent Email (temp)</label>
            <input id="studentPhone" name="studentPhone" placeholder="Enter parent email" required />
            <label for="studentOtp">Password (temp)</label>
            <input id="studentOtp" name="studentOtp" type="password" placeholder="Enter password" required />
            <button class="btn" type="submit" style="background:#0b6ef3;color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;">Login</button>
            <p class="error" id="studentError" hidden style="color:#ef4444;font-size:13px;">Login failed.</p>
          </form>
        </div>
      </div>

      <!-- Teacher -->
      <div id="teacherTab" role="tabpanel" aria-labelledby="teacherTabBtn" hidden>
        <div class="card">
          <h3>Teacher Login</h3>
          <form class="login" onsubmit="return false" style="display:grid;gap:10px;">
            <label for="tphone">Teacher Email</label>
            <input id="tphone" name="tphone" placeholder="Enter teacher email" required />
            <label for="tpass">Password</label>
            <input id="tpass" name="tpass" type="password" placeholder="Enter password" required />
            <button class="btn" type="submit" style="background:#0b6ef3;color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;">Login</button>
            <p class="error" id="teacherError" hidden style="color:#ef4444;font-size:13px;">Login failed.</p>
          </form>
        </div>
      </div>

      <!-- Accounts -->
      <div id="accountsTab" role="tabpanel" aria-labelledby="accountsTabBtn" hidden>
        <div class="card">
          <h3>Accounts Login</h3>
          <form class="login" onsubmit="return false" style="display:grid;gap:10px;">
            <label for="acctUser">Accounts Email</label>
            <input id="acctUser" name="acctUser" placeholder="Enter accounts email" required />
            <label for="acctPass">Password</label>
            <input id="acctPass" name="acctPass" type="password" placeholder="Enter password" required />
            <button class="btn" type="submit" style="background:#0b6ef3;color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;">Login</button>
            <p class="error" id="accountsError" hidden style="color:#ef4444;font-size:13px;">Login failed.</p>
          </form>
        </div>

        <!-- Quick Fees Console (Demo only) -->
        <div class="card" style="margin-top:12px;">
          <h3>Quick Fees Console (Demo)</h3>
          <form class="login" onsubmit="return false" style="display:grid;gap:10px;">
            <label for="acctAdm">Admission No.</label>
            <input id="acctAdm" name="acctAdm" placeholder="RSPS/2025/0123" />
            <label for="acctMonth">Month</label>
            <input id="acctMonth" name="acctMonth" placeholder="e.g., July 2025" />
            <label for="acctAmount">Amount (₹)</label>
            <input id="acctAmount" name="acctAmount" type="number" min="0" step="1" placeholder="e.g., 1200" />
            <label for="acctMode">Mode</label>
            <input id="acctMode" name="acctMode" placeholder="UPI / NEFT / Cash" />
            <label for="acctUtr">UTR/Ref (optional)</label>
            <input id="acctUtr" name="acctUtr" placeholder="Bank ref no." />
            <div class="actions" style="display:flex;gap:10px;flex-wrap:wrap;">
              <button type="button" class="btn btn-outline" style="color:#0b6ef3;background:#fff;border:1px solid #0b6ef3;border-radius:10px;padding:10px 14px;font-weight:700;" onclick="alert('Demo: Payment recorded (not saved).')">Record Payment (Demo)</button>
              <button type="button" class="btn" style="background:#0b6ef3;color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;" onclick="alert('Demo: Receipt PDF generated.')">Generate Receipt (Demo)</button>
            </div>
            <p class="small" style="color:#6b7280;">Note: Front-end demo only. Real ledger + PDF will be wired after dashboards.</p>
          </form>
        </div>
      </div>

      <!-- Admin -->
      <div id="adminTab" role="tabpanel" aria-labelledby="adminTabBtn" hidden>
        <div class="card">
          <h3>Admin Login</h3>
          <form class="login" onsubmit="return false" style="display:grid;gap:10px;">
            <label for="aemail">Admin Email</label>
            <input id="aemail" name="aemail" type="email" placeholder="admin@example.com" required />
            <label for="apass">Password</label>
            <input id="apass" name="apass" type="password" placeholder="Enter password" required />
            <button class="btn" type="submit" style="background:#0b6ef3;color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:700;">Login</button>
            <p class="error" id="adminError" hidden style="color:#ef4444;font-size:13px;">Login failed.</p>
          </form>
        </div>
      </div>
    </div>

    <!-- tiny tab JS -->
    <script>
      function showTab(which){
        const tabs = ['student','teacher','accounts','admin'];
        tabs.forEach(t => {
          document.getElementById(t+'Tab').hidden = (t !== which);
          const btn = document.getElementById(t+'TabBtn');
          if (!btn) return;
          btn.classList.toggle('active', t === which);
          btn.setAttribute('aria-selected', t === which ? 'true' : 'false');
        });
      }
    </script>
  </div>
</section>


  <!-- Footer -->
  <footer>
    <div class="container foot">
      <div>
        <img class="logo" src="Rising Stars logo RSPS png.png" alt="Rising Stars Logo" style="height:50px;">
        <p class="small">Serving our rural community with care and quality education. Our motto – <strong>Parampara : Prodyogiki : Prakastha</strong> – blends tradition, technology, and excellence.<br/>Address: Village Shyampur, P.O. Gorkhuwala, Tehsil Paonta Sahib, District Sirmour, Himachal Pradesh – 173025</p>
      </div>
      <div>
        <strong>Quick Links</strong>
        <ul class="small" style="list-style:none; padding-left:0;">
          <li><a href="#about">About Us</a></li>
          <li><a href="#admissions">Admissions</a></li>
          <li><a href="#gallery">Image Gallery</a></li>
          <li><a href="#enquiry">Enquiry</a></li>
          <li><a href="#contact">Contact</a></li>
        </ul>
      </div>
      <div>
        <strong>Contact</strong>
        <p class="small">Email: <a href="mailto:rspsshyampur@gmail.com">rspsshyampur@gmail.com</a><br/>Phone: (to be updated)</p>
      </div>
    </div>
    <div class="container" style="margin-top:12px;">
      <p class="small">© <span id="year"></span> Rising Stars Public School. All rights reserved.</p>
    </div>
  </footer>

  <script>
    function toggleMenu(){
      const el = document.getElementById('mobileMenu');
      el.classList.toggle('open');
    }

    // Build WhatsApp link from form
    function enquirySubmit(e){
      e.preventDefault();
      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const student = document.getElementById('student').value.trim();
      const cls = document.getElementById('class').value;
      const msg = document.getElementById('message').value.trim();

      const schoolNumber = '919999999999'; // TODO: replace with your WhatsApp number (without +)
      const text = `Admission Enquiry\nParent: ${name}\nPhone: ${phone}\nStudent: ${student}\nClass: ${cls}\nMessage: ${msg}`;
      const url = `https://wa.me/${schoolNumber}?text=${encodeURIComponent(text)}`;

      document.getElementById('waLink').href = url;
      // Also open WhatsApp directly for convenience:
      window.open(url, '_blank');
      return false;
    }

    // Year in footer
    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
  <!-- Supabase auth + role routing -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script>
  // 1) PROJECT CREDS
  const SUPABASE_URL  = "https://eqbbddsjutlupckqzlpq.supabase.co";
  const SUPABASE_ANON = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVxYmJkZHNqdXRsdXBja3F6bHBxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2NDkzOTMsImV4cCI6MjA3MDIyNTM5M30.CVmsiBCCp98ZQQOEe-1QgrvcJGeRP4DGHUx6j0wPCRI";
  const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON);

  // 2) HELPERS
async function getMyProfile(userId) {
  const uid = userId;
  const { data, error } = await sb
    .from("profiles")
    .select("full_name, role")
    .eq("user_id", uid)
    .single();
  if (error) throw error;
  return data;
}


  function goRole(role){
    if (role === "admin")       window.location.href = "admin-dashboard.html";
    else if (role === "accounts") window.location.href = "accounts-dashboard.html"; // create this file
    else if (role === "teacher")  window.location.href = "teacher-dashboard.html";  // create this file
    else if (role === "parent")   window.location.href = "parent-dashboard.html";   // create this file
    else alert("Unknown role: " + role);
  }

  function showErr(elId, err){
    console.error(err);
    const el = document.getElementById(elId);
    if (!el) { alert(err?.message || "Login failed"); return; }
    el.hidden = false;
    el.textContent = (err?.message || 'Login failed');
    setTimeout(()=>{ el.hidden = true; }, 6000);
  }

  // 3) FORM HANDLERS

// ADMIN (with debug)
const adminForm = document.querySelector("#adminTab form.login");
if (adminForm) adminForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("aemail").value.trim();
  const pass  = document.getElementById("apass").value;

  try {
    console.log("Trying signInWithPassword for:", JSON.stringify(email), "len:", email.length);
    const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
    console.log("signIn result:", { data, error }); // <- will show the exact reason if it fails

    if (error) throw error;           // e.g., "Invalid login credentials"
    const user = data.user;           // returned user (avoid getUser() race)
    const p = await getMyProfile(user.id);
    if (p.role !== "admin") throw new Error("This user is not an admin");
    goRole(p.role);                   // redirect to admin-dashboard.html
  } catch (err) {
    showErr("adminError", err);       // shows red text above the form
  }
});



// ACCOUNTS
const accountsForm = document.querySelector("#accountsTab form.login");
if (accountsForm) accountsForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("acctUser").value.trim();
  const pass  = document.getElementById("acctPass").value;
  try {
    const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
    if (error) throw error;
    const user = data.user;
    const p = await getMyProfile(user.id);
    if (p.role !== "accounts") throw new Error("This user is not accounts role");
    goRole(p.role);
  } catch (err) { showErr("accountsError", err); }
});


  // TEACHER (for now, enter teacher EMAIL in the “Mobile” field)
// TEACHER (for now, enter teacher EMAIL in the “Teacher Email” field)
const teacherForm = document.querySelector("#teacherTab form.login");
if (teacherForm) teacherForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("tphone").value.trim();
  const pass  = document.getElementById("tpass").value;
  try {
    const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
    if (error) throw error;
    const user = data.user;
    const p = await getMyProfile(user.id);
    if (p.role !== "teacher") throw new Error("This user is not teacher role");
    goRole(p.role);
  } catch (err) { showErr("teacherError", err); }
});


  // PARENT (temporary: email in Parent Email field + password in Password field)
const parentForm = document.querySelector("#studentTab form.login");
if (parentForm) parentForm.addEventListener("submit", async (e) => {
  e.preventDefault();
  const email = document.getElementById("studentPhone").value.trim();
  const pass  = document.getElementById("studentOtp").value;
  try {
    const { data, error } = await sb.auth.signInWithPassword({ email, password: pass });
    if (error) throw error;
    const user = data.user;
    const p = await getMyProfile(user.id);
    if (p.role !== "parent") throw new Error("This user is not parent role");
    goRole(p.role);
  } catch (err) { showErr("studentError", err); }
});

</script>


</body>
</html>
